<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é’¢ç´éšæœºéŸ³å¬è¾¨ï¼ˆå°¤å…‹é‡Œé‡Œ 23å¯¸ 18å“ï¼‰</title>
<script src="js/Tone.js"></script>
<script type="module" src="modules/core/config.js"></script>
<script type="module" src="main.js"></script>
<script type="module" src="modules/core/boot.js"></script>

<link rel="stylesheet" href="style.css">
<link rel="icon" href="favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="modules/modes/start-screen.css">
<link rel="stylesheet" href="modules/ui/stats-modal.css">
<style>
/* å¯ç”¨é¡¶éƒ¨æ ‡é¢˜æ  */
.daw-header {
    display: flex;
    background: var(--card);
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    border-bottom: 1px solid var(--btn-sec);
    box-shadow: 0 2px 10px var(--shadow);
    height: 60px;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
}

.app-title {
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
    font-family: var(--font-system);
}

.app-title small {
    font-size: 14px;
    color: var(--sub);
    font-weight: 400;
    margin-left: 8px;
}

.header-controls {
    display: flex;
    gap: 8px;
    align-items: center;
    position: relative;
}

/* éšè—åŸæœ‰çš„åº•éƒ¨æŒ‰é’®ç»„ */
.btn-group {
    display: none !important;
}

/* å¯ç”¨å·¦ä¾§é¢æ¿ */
.left-panel {
    display: block;
    position: fixed;
    top: 60px;
    left: 0;
    width: 280px;
    height: calc(100vh - 60px);
    background: var(--card);
    border-right: 1px solid var(--btn-sec);
    padding: 20px;
    overflow-y: auto;
    z-index: 900;
}

.panel-section {
    margin-bottom: 24px;
}



.control-group {
    margin-bottom: 16px;
}

.control-label {
    display: block;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--text);
    padding-bottom: 4px;
    border-bottom: 1px solid var(--btn-sec);
    font-family: var(--font-system);
}

/* ä¿®æ”¹éŸ³åŸŸæŒ‰é’®ç»„æ ·å¼ - ä¸‰ä¸ªæŒ‰é’®è¿åœ¨ä¸€èµ· */
.range-buttons {
    display: flex;
    margin-bottom: 12px;
    background: var(--btn-sec);
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid var(--btn-sec);
}

.range-btn, .mode-btn {
    flex: 1;
    padding: 10px;
    border: none;
    background: var(--btn-sec);
    color: var(--text);
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    font-size: 13px;
    position: relative;
}

/* ç§»é™¤æŒ‰é’®ä¹‹é—´çš„é—´éš” */
.range-btn {
    margin: 0;
    border-radius: 0;
}

/* ç¬¬ä¸€ä¸ªæŒ‰é’®å·¦è¾¹åœ†è§’ */
.range-btn:first-child {
    border-top-left-radius: 7px;
    border-bottom-left-radius: 7px;
}

/* æœ€åä¸€ä¸ªæŒ‰é’®å³è¾¹åœ†è§’ */
.range-btn:last-child {
    border-top-right-radius: 7px;
    border-bottom-right-radius: 7px;
}

/* æŒ‰é’®ä¹‹é—´çš„åˆ†éš”çº¿ */
.range-btn:not(:last-child)::after {
    content: '';
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    height: 60%;
    width: 1px;
    background: var(--btn-sec-h);
}

/* åŸºå‡†éŸ³è®¾ç½®çš„ä¸¤ä¸ªæŒ‰é’®æ ·å¼ */
.mode-buttons {
    display: flex !important;
    margin-bottom: 12px !important;
    width: 66.66% !important;
}

.mode-btn {
    margin: 0;
    border-radius: 0;
    flex: 1;
    padding: 10px;
    border: none;
    background: var(--btn-sec);
    color: var(--text);
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    font-size: 13px;
    position: relative;
}

/* ç¬¬ä¸€ä¸ªæ¨¡å¼æŒ‰é’®å·¦è¾¹åœ†è§’ */
.mode-btn:first-child {
    border-top-left-radius: 7px;
    border-bottom-left-radius: 7px;
}

/* æœ€åä¸€ä¸ªæ¨¡å¼æŒ‰é’®å³è¾¹åœ†è§’ */
.mode-btn:last-child {
    border-top-right-radius: 7px;
    border-bottom-right-radius: 7px;
}

/* æ¨¡å¼æŒ‰é’®ä¹‹é—´çš„åˆ†éš”çº¿ */
.mode-btn:not(:last-child)::after {
    content: '';
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    height: 60%;
    width: 1px;
    background: var(--btn-sec-h);
}

.range-btn.active, .mode-btn.active {
    background: var(--accent-color);
    color: white;
}

/* æ¿€æ´»çŠ¶æ€ä¸‹ç§»é™¤åˆ†éš”çº¿ */
.range-btn.active::after,
.range-btn.active + .range-btn::after,
.mode-btn.active::after,
.mode-btn.active + .mode-btn::after {
    display: none;
}


/* ç¡®ä¿æ ‡é¢˜æ ä¸­çš„å›¾æ ‡æŒ‰é’®æ ·å¼æ­£ç¡® */
.daw-header .icon-btn {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: var(--btn-sec);
    color: var(--text);
    cursor: pointer;
    transition: all 0.2s;
    font-size: 14px;
}

.daw-header .icon-btn:hover {
    background: var(--btn-sec-h);
}

/* éŸ³é‡æ§åˆ¶æ ·å¼ */
.daw-header .volume-control {
    position: relative;
    display: flex;
    align-items: center;
    height: 32px;
}

.daw-header .volume-slider-container {
    position: absolute;
    top: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%) translateY(-10px);
    background: var(--card);
    padding: 12px;
    border-radius: 10px;
    box-shadow: 0 4px 20px var(--shadow);
    border: 1px solid var(--btn-sec);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1000;
    min-width: 120px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.daw-header .volume-control:hover .volume-slider-container {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
}

.daw-header .volume-control.hide-slider .volume-slider-container {
    opacity: 0 !important;
    visibility: hidden !important;
    transform: translateX(-50%) translateY(-10px) !important;
}

.daw-header #volumeSlider {
    width: 90px;
    height: 5px;
    border-radius: 3px;
    background: var(--btn-sec);
    outline: none;
    cursor: pointer;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    margin: 0 auto;
}

/* Webkit æµè§ˆå™¨ (Chrome, Safari, Edge Chromium) */
.daw-header #volumeSlider::-webkit-slider-track {
    width: 100%;
    height: 5px;
    border-radius: 3px;
    background: var(--btn-sec);
    border: none;
}

.daw-header #volumeSlider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--accent-color);
    cursor: pointer;
    border: 2px solid var(--card);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    margin-top: -5.5px;
}

/* Firefox */
.daw-header #volumeSlider::-moz-range-track {
    width: 100%;
    height: 5px;
    border-radius: 3px;
    background: var(--btn-sec);
    border: none;
}

.daw-header #volumeSlider::-moz-range-thumb {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--accent-color);
    cursor: pointer;
    border: 2px solid var(--card);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    border: none;
}

.daw-header #volumeSlider::-webkit-slider-track {
    width: 100%;
    height: 5px;
    border-radius: 3px;
    background: var(--btn-sec);
    border: none;
}

.daw-header #volumeSlider::-webkit-slider-thumb {
    appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--accent-color);
    cursor: pointer;
    border: 2px solid var(--card);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    margin-top: -5.5px;
}

.daw-header .volume-slider-container::after {
    content: attr(data-volume);
    display: block;
    text-align: center;
    font-size: 11px;
    color: var(--sub);
    font-weight: 500;
    width: 100%;
    position: absolute;
    bottom: -18px;
    left: 0;
}

/* éšè—å¡ç‰‡å†…é‡å¤çš„è®¾ç½®é¡¹ */
#card .reference-controls .control-row:first-child,
#card .reference-controls .control-row:nth-child(2) {
    display: none;
}

@media (max-width: 768px) {
    .key-btn {
        padding: 20px 6px !important;
        font-size: 1.6rem !important;
        min-height: 70px !important;
    }
}

/* ç¡®ä¿æ¨¡æ€æ¡†åœ¨æ ‡é¢˜æ ä¹‹ä¸Š */
#rangeModal,
#settingsModal {
    z-index: 1001;
}

#rangeMask,
#settingsMask {
    z-index: 1000;
}

/* æš‚æ—¶ä¿æŒå…¶ä»–ç»„ä»¶éšè— */
.status-bar {
    display: none;
}

/* é€‰æ‹©æ¡†æ ·å¼ */
select {
    width: 100%;
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid var(--btn-sec);
    background: var(--card);
    color: var(--text);
    font-size: 14px;
    font-family: var(--font-system);
}

/* æŒ‰é’®æ ·å¼ */
.btn-secondary {
    padding: 8px 16px;
    background: var(--btn-sec);
    color: var(--text);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 14px;
    font-family: var(--font-system);
}

.btn-secondary:hover {
    background: var(--btn-sec-h);
}

/* åŸºå‡†éŸ³è®¾ç½®æŒ‰é’®æ ·å¼ */
.left-panel .mode-buttons {
    display: flex !important;
    margin-bottom: 12px !important;
    width: 100% !important; 
    background: var(--btn-sec) !important;
    border-radius: 8px !important;
    overflow: hidden !important;
    border: 1px solid var(--btn-sec) !important;
}

.left-panel .mode-btn {
    flex: 1 !important;
    padding: 10px !important;
    border: none !important;
    background: var(--btn-sec) !important;
    color: var(--text) !important;
    cursor: pointer !important;
    text-align: center !important;
    transition: all 0.2s !important;
    font-size: 13px !important;
    position: relative !important;
    border-radius: 0 !important; /* ç§»é™¤åœ†è§’ */
    margin: 0 !important;
}

/* ç¬¬ä¸€ä¸ªæ¨¡å¼æŒ‰é’®å·¦è¾¹åœ†è§’ */
.left-panel .mode-btn:first-child {
    border-top-left-radius: 7px !important;
    border-bottom-left-radius: 7px !important;
}

/* æœ€åä¸€ä¸ªæ¨¡å¼æŒ‰é’®å³è¾¹åœ†è§’ */
.left-panel .mode-btn:last-child {
    border-top-right-radius: 7px !important;
    border-bottom-right-radius: 7px !important;
}

/* æ¨¡å¼æŒ‰é’®ä¹‹é—´çš„åˆ†éš”çº¿ */
.left-panel .mode-btn:not(:last-child)::after {
    content: '' !important;
    position: absolute !important;
    right: 0 !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    height: 60% !important;
    width: 1px !important;
    background: var(--btn-sec-h) !important;
}

.left-panel .mode-btn.active {
    background: var(--accent-color) !important;
    color: white !important;
}

/* æ¿€æ´»çŠ¶æ€ä¸‹ç§»é™¤åˆ†éš”çº¿ */
.left-panel .mode-btn.active::after,
.left-panel .mode-btn.active + .mode-btn::after 
{
    display: none !important;
}


</style>
<script>
    // è…¾è®¯äº‘ç¯å¢ƒé…ç½®
    window.TCB_ENV = "cloud1-1gjdagdx9419c0e8";
</script>
</head>
<body>
<!-- å¼€å§‹å±å¹•è¦†ç›–å±‚ -->
<div id="startScreen" class="start-screen active">
    <div class="start-container">
        <div class="app-brand">
            <h1>ğŸµ å•éŸ³å¬è¾¨è®­ç»ƒå™¨</h1>
            <p>æå‡éŸ³ä¹æ„ŸçŸ¥èƒ½åŠ›ï¼Œä»ç²¾å‡†å¬è¾¨å¼€å§‹</p>
        </div>

        <div class="mode-selection">
            <!-- æ ‡å‡†æ¨¡å¼å¡ç‰‡ -->
            <div class="mode-card" data-mode="standard">
                <div class="mode-icon">ğŸ¹</div>
                <div class="mode-content">
                    <h3>æ ‡å‡†æ¨¡å¼</h3>
                    <p>è‡ªç”±ç»ƒä¹ ï¼Œéšå¿ƒè®¾ç½®è°ƒæ€§ã€éŸ³åŸŸå’Œéš¾åº¦</p>
                    <ul class="mode-features">
                        <li>â€¢ å®Œæ•´çš„è‡ªå®šä¹‰è®¾ç½®</li>
                        <li>â€¢ æ¸è¿›å¼éš¾åº¦è°ƒæ•´</li>
                        <li>â€¢ å®æ—¶åé¦ˆå’Œç»Ÿè®¡</li>
                    </ul>
                </div>
                <button class="select-mode-btn">è¿›å…¥ç»ƒä¹ </button>
            </div>

            <!-- æŒ‘æˆ˜æ¨¡å¼å¡ç‰‡ -->
            <div class="mode-card" data-mode="challenge">
                <div class="mode-icon">âš¡</div>
                <div class="mode-content">
                    <h3>æŒ‘æˆ˜æ¨¡å¼</h3>
                    <p>é™æ—¶æŒ‘æˆ˜ï¼Œæµ‹è¯•ä½ çš„å¬è¾¨æé™</p>
                    <ul class="mode-features">
                        <li>â€¢ æ—¶é—´é™åˆ¶å’Œåˆ†æ•°ç³»ç»Ÿ</li>
                        <li>â€¢ é€æ­¥æå‡çš„éš¾åº¦æ›²çº¿</li>
                        <li>â€¢ æˆå°±å’Œæ’è¡Œæ¦œ</li>
                    </ul>
                </div>
                <button class="select-mode-btn">å¼€å§‹æŒ‘æˆ˜</button>
            </div>

            <!-- ä¸“é¡¹è®­ç»ƒå¡ç‰‡ -->
            <div class="mode-card" data-mode="focused">
                <div class="mode-icon">ğŸ¯</div>
                <div class="mode-content">
                    <h3>ä¸“é¡¹è®­ç»ƒ</h3>
                    <p>æ™ºèƒ½åˆ†æè–„å¼±ç¯èŠ‚ï¼Œé’ˆå¯¹æ€§å¼ºåŒ–è®­ç»ƒ</p>
                    <ul class="mode-features">
                        <li>â€¢ åŸºäºæ•°æ®çš„æ™ºèƒ½æ¨è</li>
                        <li>â€¢ ä¸ªæ€§åŒ–è®­ç»ƒè®¡åˆ’</li>
                        <li>â€¢ è¿›æ­¥è¿½è¸ªå’ŒæŠ¥å‘Š</li>
                    </ul>
                </div>
                <button class="select-mode-btn">å®šåˆ¶è®­ç»ƒ</button>
            </div>
        </div>

        <div class="start-footer">
            <div class="quick-stats">
                <div class="stat">
                    <span class="stat-number" id="totalSessions">0</span>
                    <span class="stat-label">æ€»ç»ƒä¹ æ¬¡æ•°</span>
                </div>
                <div class="stat">
                    <span class="stat-number" id="currentStreak-num">0</span>
                    <span class="stat-label">è¿ç»­ç»ƒä¹ å¤©æ•°</span>
                </div>
                <div class="stat">
                    <span class="stat-number" id="bestAccuracy">0%</span>
                    <span class="stat-label">æœ€ä½³å‡†ç¡®ç‡</span>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="layout-grid-container">
<!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
<header class="daw-header">
<div class="header-left">
        <button id="returnToStart" class="icon-btn" title="è¿”å›å¼€å§‹å±å¹• (ESC)" style="display: none;">
            ğŸ 
        </button>
        <div class="app-title" style="cursor: pointer;" title="ç‚¹å‡»è¿”å›å¼€å§‹å±å¹•">
            å•éŸ³å¬è¾¨è®­ç»ƒå™¨ <small>æå‡éŸ³ä¹æ„ŸçŸ¥èƒ½åŠ›ï¼Œä»ç²¾å‡†å¬è¾¨å¼€å§‹</small>
        </div>
    </div>
    <div class="header-controls">
        <button id="themeToggle" class="icon-btn" title="åˆ‡æ¢æ—¥/å¤œæ¨¡å¼">
            <span class="icon sun">â˜€ï¸</span>
            <span class="icon moon">ğŸŒ™</span>
        </button>
        <!-- éŸ³é‡æ§åˆ¶ -->
        <div class="volume-control">
            <button id="volumeToggle" class="icon-btn" title="éŸ³é‡æ§åˆ¶">ğŸ”Š</button>
            <div class="volume-slider-container">
                <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.7">
            </div>
        </div>

        <button id="resetQuestionBtn" class="icon-btn" title="å¤ä½å½“å‰é¢˜ç›®ï¼ˆRé”®ï¼‰">ğŸ”„</button>
        <button id="settingsBtn" class="icon-btn" title="è®¾ç½®">âš™ï¸</button>
    </div>
</header>
<!-- å·¦ä¾§è®¾ç½®é¢æ¿ -->
<aside class="left-panel">
    <div class="panel-section">
        <h3 class="panel-title">éŸ³åŸŸè®¾ç½®</h3>
        <div class="range-buttons">
            <button class="range-btn active" data-range="low">å°å­—ç»„</button>
            <button class="range-btn" data-range="mid">å°å­—ä¸€ç»„</button>
        </div>
    </div>

    <div class="panel-section">
        <h3 class="panel-title">åŸºå‡†éŸ³è®¾ç½®</h3>
        <div class="control-group">
        <!-- ç›´æ¥ä¿ç•™è¿™ä¸ªdivå’Œé‡Œé¢çš„æŒ‰é’® -->
        <div class="mode-buttons">
            <button class="mode-btn active" data-mode="c">å›ºå®šC</button>
            <button class="mode-btn" data-mode="a">å›ºå®šA</button>
        </div>
    </div>
        
        <div class="control-group">
            <label class="control-label">è°ƒæ€§</label>
            <select id="keySelect">
                <option value="C">Cè°ƒ</option>
                <option value="D">Dè°ƒ</option>
                <option value="E">Eè°ƒ</option>
                <option value="F">Fè°ƒ</option>
                <option value="G">Gè°ƒ</option>
                <option value="A">Aè°ƒ</option>
                <option value="B">Bè°ƒ</option>
            </select>
        </div>

        <div class="control-group">
            <label class="control-label">éš¾åº¦</label>
            <select id="difficultySelect">
                <option value="basic">ä»…åŸºæœ¬éŸ³çº§</option>
                <option value="extended">å«å˜åŒ–éŸ³çº§</option>
            </select>
        </div>
    </div>

    <div class="panel-section">
        <h3 class="panel-title">æ’­æ”¾é€‰é¡¹</h3>
        <div class="checkbox-option">
            <input type="checkbox" id="autoNextCheckbox">
            <label for="autoNextCheckbox">è‡ªåŠ¨ä¸‹ä¸€éŸ³</label>
            <input type="range" id="infoDisplayTime" min="1" max="5" value="3" class="time-slider" disabled>
            <span id="timeDisplay" style="opacity: 0.5; color: var(--text);">3ç§’</span>
        </div>
        <div class="checkbox-option">
            <input type="checkbox" id="enableScalePlayback" checked>
            <label for="enableScalePlayback">å…ˆæ’­æ”¾éŸ³é˜¶</label>
        </div>
    </div>
    <div class="panel-section">
        <h3 class="panel-title">è‡ªå®šä¹‰é‡‡æ ·</h3>
        <button id="customBtn" class="btn-secondary" style="width:100%;margin-bottom:8px;">è‡ªå®šä¹‰é‡‡æ ·</button>
        <button id="resetBtn" class="btn-secondary" style="width:100%;">æ¢å¤é»˜è®¤é‡‡æ ·</button>
        <input type="file" id="fileIn" multiple accept="audio/*" style="display:none">
        <div id="samplingStatus" style="margin-top:12px;font-size:12px;color:var(--sub); display: none;">
        </div>
    </div>
</aside>
<!-- ä¸­å¤®ä¸»åŒºåŸŸ -->
<main class="main-content">
    <div class="central-container">
        <!-- å¤§æ’­æ”¾æŒ‰é’® -->
        <div id="big-play-btn" class="big-play-button">
            <div class="big-play-icon icon-play"></div>
        </div>
    
        <!-- æ¶ˆæ¯æ˜¾ç¤º -->
        <div id="msg" style="display: block;">ç‚¹å‡»å¼€å§‹è®­ç»ƒ</div>
        
        <!-- æ·»åŠ é”®ç›˜æç¤º -->
        <div class="keyboard-hint" style="font-size: 12px; color: var(--sub); margin-top: 8px;">
            ç©ºæ ¼é”®æ’­æ”¾ Â· Ré”®å¤ä½
        </div>
        
        <div id="statusBox"></div>
        <button id="startBtn" class="btn-primary" style="display: none;">æ’­æ”¾é¢˜ç›®</button>
        <div id="ans"></div>
    </div>

        <!-- æµ®åŠ¨é¢æ¿ -->
<div id="simplePanel" class="simple-panel">
        <div class="panel-header">
        <div class="panel-title">éŸ³é«˜ä¿¡æ¯</div>
        <div class="panel-controls">
            <button class="panel-close" title="å…³é—­é¢æ¿">âœ•</button>
        </div>
    </div>
    
        <!-- æ»‘åŠ¨å®¹å™¨ -->
        <div class="swipe-container">
<!-- éŸ³é«˜é¡µé¢ -->
<div class="swipe-page active" id="pitch-page">
    <div class="welcome-overlay active">
        <div class="welcome-icon">ğŸµ</div>
        <h3 class="welcome-title">å¬éŸ³è¾¨è¯†</h3>
        <p class="welcome-subtitle">æ¢ç´¢éŸ³ä¹çš„ä¸–ç•Œï¼Œæå‡å¬éŸ³èƒ½åŠ›</p>
        <div class="welcome-swipe-hint">â—€ æ»‘åŠ¨æŸ¥çœ‹å…¶ä»–ä¿¡æ¯ â–¶</div>
    </div>
    
    <div class="pitch-content">
        <span class="dominant-pitch" id="currentPitch"></span>
        <span class="watermark-degree" id="currentDegree"></span>
        <span class="frequency-display" id="currentFrequency"></span>
    </div>
</div>

<!-- éŸ³ç¨‹é¡µé¢ -->
<div class="swipe-page" id="interval-page">
    <div class="welcome-overlay active">
        <div class="welcome-icon">ğŸ¶</div>
        <h3 class="welcome-title">éŸ³ç¨‹åˆ†æ</h3>
        <p class="welcome-subtitle">äº†è§£éŸ³ç¬¦ä¹‹é—´çš„å’Œè°å…³ç³»</p>
        <div class="welcome-swipe-hint">â—€ æ»‘åŠ¨æŸ¥çœ‹å…¶ä»–ä¿¡æ¯ â–¶</div>
    </div>
    
    <div class="interval-content">
        <div class="interval-name" id="intervalName">--</div>
        <div class="interval-detail" id="intervalDetail">--</div>
        <div class="interval-properties">
            <div class="property-group">
                <div class="property-row">
                    <span class="property-label">ç¨³å®šæ€§</span>
                    <span class="property-value" id="intervalStability">--</span>
                </div>
                <div class="property-row">
                    <span class="property-label">è§£å†³å€¾å‘</span>
                    <span class="property-value" id="intervalTendency">--</span>
                </div>
            </div>
            <div class="property-group">
                <div class="property-row">
                    <span class="property-label">éŸ³ç¨‹æ€§è´¨</span>
                    <span class="property-value" id="intervalNature">--</span>
                </div>
                <div class="property-row">
                    <span class="property-label">è‰²å½©ç‰¹å¾</span>
                    <span class="property-value" id="intervalColor">--</span>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- å°¤å…‹é‡Œé‡Œé¡µé¢ -->
<div class="swipe-page" id="ukulele-page">
    <div class="welcome-overlay active">
        <div class="welcome-icon">ğŸ¸</div>
        <h3 class="welcome-title">å°¤å…‹é‡Œé‡ŒæŒ‡ä½</h3>
        <p class="welcome-subtitle">æ¢ç´¢éŸ³é«˜çš„å¤šç§æŒ‰æ³•</p>
        <div class="welcome-swipe-hint">â—€ æ»‘åŠ¨æŸ¥çœ‹å…¶ä»–ä¿¡æ¯ â–¶</div>
    </div>
    
    <div class="ukulele-content">
        <!-- ä¸»è¦ä¿¡æ¯åŒºåŸŸ - å·¦å³å¸ƒå±€ -->
        <div class="uke-main-info">
            <!-- å·¦ä¾§ï¼šéŸ³åä¿¡æ¯ + ä¸‹æ‹‰æ¡† -->
            <div class="uke-left-section">
                <div class="uke-note-section">
                    <div class="uke-note-name">
                        <span class="uke-note" id="ukeNoteName">--</span>
                        <span class="uke-note-type" id="ukeNoteType">--</span>
                    </div>
                </div>
                <!-- è°ƒæ€§é€‰æ‹©å™¨æ”¾åœ¨éŸ³åæ­£ä¸‹æ–¹ -->
                <div class="uke-key-selector">
                    <select id="ukeKeySelect" class="uke-key-dropdown">
                        <option value="C">Cè°ƒ</option>
                        <option value="D">Dè°ƒ</option>
                        <option value="E">Eè°ƒ</option>
                        <option value="F">Fè°ƒ</option>
                        <option value="G">Gè°ƒ</option>
                        <option value="A">Aè°ƒ</option>
                        <option value="B">Bè°ƒ</option>
                    </select>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼šæŒ‡ä½ä¿¡æ¯ -->
            <div class="uke-right-section">
                <!-- å¸¸ç”¨æŒ‡ä½ -->
                <div class="uke-position-group">
                    <div class="position-label">å¸¸ç”¨æŒ‡ä½</div>
                    <div class="position-values" id="ukeCommonPositions">--</div>
                </div>
                
                <!-- é«˜æŠŠä½æŒ‡ä½ -->
                <div class="uke-position-group">
                    <div class="position-label">é«˜æŠŠä½æŒ‡ä½</div>
                    <div class="position-values" id="ukeHighPositions">--</div>
                </div>
            </div>
        </div>
        
        <!-- åº•éƒ¨ï¼šå’Œå¼¦ä¿¡æ¯ -->
        <div class="uke-chords-section">
            <div class="chords-label">ç›¸å…³å’Œå¼¦ï¼š</div>
            <div class="chords-values" id="ukeRelatedChords">--</div>
        </div>
    </div>
</div>
    <!-- é¡µé¢æŒ‡ç¤ºå™¨ -->
    <div class="page-indicator">
        <span class="indicator-dot active" data-page="0"></span>
        <span class="indicator-dot" data-page="1"></span>
        <span class="indicator-dot" data-page="2"></span>
    </div>
    </div>
</div> 
</main>

<!-- å³ä¾§é¢æ¿ -->
<!-- æ˜¾ç¤ºé¢æ¿æŒ‰é’® -->
<button id="showSimplePanel" class="icon-btn" style="display:none;">ğŸ“Š</button>

<aside class="right-panel">
    <div class="panel-section">
        <h3 class="panel-title">ğŸ“Š ç»ƒä¹ ç»Ÿè®¡</h3>

        <!-- æ ¸å¿ƒæŒ‡æ ‡ - ç®€çº¦é£æ ¼ -->
        <div class="key-metrics-simple">
            <div class="stats-section">
                <!-- æ€»ç»ƒä¹ æ•°é‡ -->
                <div class="stat-line">
                    <span class="stat-label">æ€»ç»ƒä¹ :</span>
                    <span class="stat-value" id="totalExercises">0é¢˜</span>
                </div>
                <div class="stat-line">
                    <span class="stat-label">æ€»æ­£ç¡®ç‡:</span>
                    <span class="stat-value" id="totalAccuracyRate">0%</span>
                </div>
                
                <!-- ä»Šæ—¥ç»Ÿè®¡ -->
                <div class="stat-line">
                    <span class="stat-label">ä»Šæ—¥ç»ƒä¹ :</span>
                    <span class="stat-value" id="totalPlays">0é¢˜</span>
                </div>
                <div class="stat-line">
                    <span class="stat-label">é¦–å‡»æ­£ç¡®:</span>
                    <span class="stat-value" id="correctCount">0é¢˜</span>
                </div>
                <div class="stat-line">
                    <span class="stat-label">é¦–å‡»æ­£ç¡®ç‡:</span>
                    <span class="stat-value" id="accuracyRate">0%</span>
                </div>
                <div class="progress-mini">
                    <div class="progress-fill-mini" id="accuracyProgress"></div>
                </div>
                
                <!-- è¿èƒœè®°å½• -->
                <div class="stat-line">
                    <span class="stat-label">å½“å‰è¿å‡»:</span>
                    <span class="stat-value" id="currentStreak-label">0è¿èƒœ</span>
                </div>
                <div class="stat-line">
                    <span class="stat-label">æœ€é«˜è¿å‡»:</span>
                    <span class="stat-value" id="maxStreak-label">0è¿èƒœ</span>
                </div>
            </div>
        </div>

        <!-- æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® -->
        <div class="view-details-section">
            <button id="viewDetailsBtn" class="view-details-btn">
                ğŸ“ˆ æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
            </button>
        </div>
    </div>

    <!-- å†å²è®°å½• -->
    <div class="panel-section">
        <h3 class="panel-title">å†å²è®°å½•</h3>
        <div class="history-list" id="historyList">
            <div class="history-empty">æš‚æ— æ’­æ”¾è®°å½•</div>
        </div>
    </div>
</aside>
<button id="mobileSidebarToggle" class="mobile-sidebar-toggle" style="display: none;">â˜°</button>
</div>
<!-- åŸæœ‰çš„æ¨¡æ€æ¡†å’Œé®ç½© -->
<div id="rangeModal">
    <h3 style="margin:0 0 12px;font-size:16px;text-align:center">é€‰æ‹©éŸ³åŸŸ</h3>
    <label style="display:block;margin:6px 0;font-size:15px"><input type="radio" name="range" value="low" checked> C4 â€“ B4</label>
    <label style="display:block;margin:6px 0;font-size:15px"><input type="radio" name="range" value="mid"> C5 â€“ B5</label>
    <label style="display:block;margin:6px 0;font-size:15px"><input type="radio" name="range" value="all"> C4 â€“ B5</label>
    <div style="text-align:center;margin-top:14px"><button id="rangeOkBtn" style="padding:4px 14px;font-size:14px">ç¡®å®š</button></div>
</div>

<div id="rangeMask"></div>

<div id="settingsMask"></div>

<div id="settingsModal" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:1002;">
    <div id="settingsBox" style="width:770px;height:630px;display:flex;background:var(--card);border-radius:24px;box-shadow:0 20px 60px var(--shadow);overflow:hidden;">
        <aside id="settingsMenu" style="flex:0 0 200px;border-right:1px solid var(--btn-sec);padding:30px 20px;">
            <button class="menuBtn active" data-panel="general">é€šç”¨</button>
            <button class="menuBtn" data-panel="sound">éŸ³è‰²</button>
            <button class="menuBtn" data-panel="about">å…³äº</button>
        </aside>
        <section id="settingsPanel" style="flex:1;padding:30px;"></section>
    </div>
</div>

<div id="toast" class="toast"></div>
<script type="module">
    // éŸ³åŸŸæŒ‰é’®äº‹ä»¶å¤„ç†ï¼ˆæ¨¡å—åŒ–ç‰ˆæœ¬ï¼‰
    import { updateRange } from './modules/ui/range-manager.js';
    
    document.addEventListener('click', function (e) {
        // åˆ¤æ–­ç‚¹å‡»çš„æ˜¯å¦æ˜¯è®¾ç½®é¢æ¿é‡Œçš„éŸ³åŸŸæŒ‰é’®
        if (e.target.classList && e.target.classList.contains('rangeBtn') && e.target.closest('#settingsPanel')) {
            const range = e.target.dataset.range;
            if (!range) return;
    
            // ä½¿ç”¨æ¨¡å—å‡½æ•°
            updateRange(range);
    
            // åŒæ­¥å·¦ä¾§é¢æ¿æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.left-panel .range-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.range === range);
            });
    
            // åŒæ­¥è®¾ç½®é¢æ¿æŒ‰é’®çŠ¶æ€
            const rangeBtnGroup = e.target.closest('#rangeBtnGroup');
            if (rangeBtnGroup) {
                rangeBtnGroup.querySelectorAll('.rangeBtn').forEach(btn => {
                    btn.classList.toggle('active', btn === e.target);
                });
            }
        }
    });
    </script>
</body>

</html>
